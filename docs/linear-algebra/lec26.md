---
title: 第26讲：复数矩阵与快速傅里叶变换（FFT）
date: 2025-12-21
---
# MIT 18.06 线性代数 第26讲：复数矩阵与快速傅里叶变换（FFT）

> **Lecture 26: Complex matrices; fast Fourier transform**
>
> **主线逻辑**：
> 1.  把线性代数从 $\mathbb{R}^n$ 正确迁移到 $\mathbb{C}^n$（重点是“内积/长度/正交”的定义变了）。
> 2.  引入最重要的复矩阵：**Fourier 矩阵** $F_n$（列正交、逆很简单）。
> 3.  **FFT (快速傅里叶变换)**：用“矩阵分解 + 递归”的视角解释为什么计算量能从 $n^2$ 降到 $n\log_2 n$（甚至是 $\frac{1}{2} n\log_2 n$ 量级）。

---

## 0. 本讲解决了哪些问题（结论先行）

1.  **为什么必须讲复数矩阵？**
    因为“实矩阵也可能有复特征值/复特征向量”。一旦向量和矩阵进入复数域，**长度、点积、正交**这些概念必须改写，否则会出现“非零向量长度为 0”这样的矛盾。

2.  **复数域里哪些概念要替换？**
    * 实数里的转置 $T$ $\rightarrow$ 升级为 **共轭转置** $H$ (Hermitian transpose)。
    * 对称矩阵 $A^T=A$ $\rightarrow$ 升级为 **Hermitian 矩阵** $A^H=A$。
    * 正交矩阵 $Q^TQ=I$ $\rightarrow$ 升级为 **酉矩阵 (Unitary)** $Q^HQ=I$。

3.  **Fourier 矩阵 $F_n$ 是什么？为什么重要？**
    * 它是一个“满矩阵”（几乎无 0），但列向量在复内积下正交。
    * 乘以 $F_n$ 就是离散傅里叶变换 (DFT) 的矩阵形式。
    * 因为列正交，$F_n^{-1}$ 非常容易写出来。

4.  **FFT 解决的是什么“计算问题”？**
    * 直接算 $y=F_n x$ 需要 $O(n^2)$ 次乘法。
    * FFT 利用矩阵的结构分解，把计算降到 $O(n\log_2 n)$。

---

## 1. 复向量：为什么 $z^Tz$ “不再是长度平方”

### 1.1 反例（课堂关键例子）
取复向量 $z = \begin{bmatrix} 1 \\ i \end{bmatrix} \in \mathbb{C}^2$。

若仍用实数里那套转置：
$$
z^T z = 1\cdot 1 + i\cdot i = 1 + (-1) = 0
$$
这会得出“非零向量长度平方为 0”的错误结论，违反了长度的正定性。

### 1.2 正确的长度平方：必须引入共轭
复数域里长度平方定义为：
$$
\| z \|^2 = z^H z = \sum_{k=1}^n \bar{z}_k z_k = \sum_{k=1}^n |z_k|^2
$$

对上面的 $z$：
$$
z^H z = \bar{1}\cdot 1 + \bar{i}\cdot i = 1 + (-i)(i) = 1+1=2
$$
因此 $\| z \| = \sqrt{2}$，这才是合理的。

### 1.3 复内积（点积）的正确写法
实向量的内积是 $y^T x$；复向量必须改为：
$$
\langle y, x \rangle = y^H x
$$

**注意**：一般情况下 $\langle y, x \rangle$ 可能是复数；但当 $y=x$ 时，$\langle z, z \rangle = z^H z \ge 0$，这就是“长度平方必须非负”的保证。

---

## 2. 复矩阵的两本“词典”：Hermitian 与 Unitary

### 2.1 Hermitian 矩阵：复数版“对称”
实数里对称矩阵是 $A^T=A$。复数里正确的替代是：
$$
A^H = A
$$
这样的矩阵叫 **Hermitian（厄米）矩阵**。

**基本直觉**：
* **对角线元素必须是实数**（因为 $a_{jj} = \bar{a}_{jj}$）。
* 如果 $a_{ij}=3+i$，则 $a_{ji}$ 必须是 $3-i$。
* **性质**：Hermitian 矩阵的所有特征值 $\lambda$ 都是**实数**，特征向量相互正交（在不同特征值下）。

### 2.2 Unitary 矩阵：复数版“正交”
实数里正交矩阵满足 $Q^TQ=I$。复数里替换为：
$$
Q^H Q = I
$$
这样的矩阵叫 **Unitary（酉）矩阵**。

**性质**：
* 列向量两两正交、且长度为 1（正交性按复内积 $\langle \cdot, \cdot \rangle$ 判定）。
* 逆矩阵就是共轭转置：
$$
Q^{-1} = Q^H
$$

---

## 3. 本讲最重要例子：Fourier 矩阵 $F_n$

### 3.1 构造核心：$n$ 次单位根
定义：
$$
w = e^{i \frac{2\pi}{n}} = \cos\left(\frac{2\pi}{n}\right) + i\sin\left(\frac{2\pi}{n}\right)
$$
它满足：
$$
w^n = 1
$$
并且 $1, w, w^2, \dots, w^{n-1}$ 均匀分布在复平面的单位圆上。

**课堂强调**：数学里下标常从 1 计数；但在傅里叶矩阵里（更贴近 EE/CS），常从 **0** 计数，直到 $n-1$。

### 3.2 Fourier 矩阵的元素公式（从 0 计数）
令行列指标 $j,k \in \{0, 1, \dots, n-1\}$，则矩阵元素为：
$$
(F_n)_{jk} = w^{jk}
$$

**结构展开**：
$$
F_n =
\begin{bmatrix}
1 & 1 & 1 & \cdots & 1 \\
1 & w & w^2 & \cdots & w^{n-1} \\
1 & w^2 & w^4 & \cdots & w^{2(n-1)} \\
\vdots & \vdots & \vdots & \ddots & \vdots \\
1 & w^{n-1} & w^{2(n-1)} & \cdots & w^{(n-1)(n-1)}
\end{bmatrix}
$$

### 3.3 “列正交”与“逆很容易”
在复内积下，Fourier 矩阵的列向量两两正交（**前提：做内积时必须取共轭**）。

并且列向量的长度相同：每列的长度是 $\sqrt{n}$。因此：
* $\frac{1}{\sqrt{n}}F_n$ 才是标准的 Unitary 矩阵。
* 逆矩阵可以直接写成：
$$
F_n^{-1} = \frac{1}{n} F_n^H
$$
这里 $F_n^H$ 中的元素是 $\bar{w}^{jk} = e^{-i \frac{2\pi jk}{n}}$。

---

## 4. 具体例子：$n=4$ 的 $F_4$

### 4.1 先求 $w$
当 $n=4$：
$$
w = e^{i \frac{2\pi}{4}} = e^{i \frac{\pi}{2}} = i
$$
其幂次循环为：$w^0=1, \quad w^1=i, \quad w^2=-1, \quad w^3=-i, \quad w^4=1$。

### 4.2 写出 $F_4$
$$
F_4 =
\begin{bmatrix}
1 & 1 & 1 & 1 \\
1 & i & -1 & -i \\
1 & -1 & 1 & -1 \\
1 & -i & -1 & i
\end{bmatrix}
$$

### 4.3 验证列正交
以第 2 列 ($c_1$) 和第 4 列 ($c_3$) 为例：
$$
c_1 = \begin{bmatrix} 1 \\ i \\ -1 \\ -i \end{bmatrix}, \quad c_3 = \begin{bmatrix} 1 \\ -i \\ -1 \\ i \end{bmatrix}
$$
内积计算（注意 $c_1$ 要取共轭）：
$$
c_1^H c_3 = 1\cdot 1 + (-i)(-i) + (-1)(-1) + (i)(i) = 1 - 1 + 1 - 1 = 0
$$
这就是为什么必须用复内积定义。

---

## 5. 从 $F_n$ 到 DFT：矩阵乘法视角

把输入向量 $x \in \mathbb{C}^n$ 变换为频域向量 $y \in \mathbb{C}^n$：
$$
y = F_n x
$$
这就是 **离散傅里叶变换 (DFT)** 的矩阵形式。
问题在于：$F_n$ 是满矩阵，直接算 $F_n x$ 需要 $n^2$ 次乘法。

---

## 6. FFT：核心是把 $F_{2n}$ 分解成“更小的 Fourier 变换”

课堂的关键思路（Strang 用 $n=64$ 与 $32$ 做示意）是利用矩阵分解。

**Step 1: 把输入按 偶/奇 下标拆开**
通过一个置换矩阵 $P$，将 $x$ 重排为：
$$
Px = \begin{bmatrix} x_{\text{even}} \\ x_{\text{odd}} \end{bmatrix} = \begin{bmatrix} x_0 \\ x_2 \\ \vdots \\ x_1 \\ x_3 \\ \vdots \end{bmatrix}
$$

**Step 2: FFT 矩阵分解公式**
$F_{2n}$ 可以被分解为以下三个矩阵的乘积：
$$
F_{2n} =
\begin{bmatrix}
I_n & D_n \\
I_n & -D_n
\end{bmatrix}
\begin{bmatrix}
F_n & 0 \\
0 & F_n
\end{bmatrix}
P
$$

其中：
* $I_n$ 是单位矩阵。
* $F_n$ 是规模减半的 Fourier 矩阵。
* $D_n$ 是对角修正矩阵（Twiddle factors）：
    $$D_n = \text{diag}(1, w, w^2, \dots, w^{n-1}) \quad (\text{注意这里的 } w \text{ 是基于 } 2n \text{ 的})$$

**这里的“便宜”来自哪里？**
* $P$ 是置换（零计算成本，只是重新连线）。
* 中间是两个半规模的 $F_n$，可以并行或递归。
* 左边矩阵只有 $I$ 和对角阵 $D$，乘法次数是线性的 $O(n)$。

---

## 7. 递归与复杂度：从 $n^2$ 到 $n\log_2 n$

设计算代价为 $T(n)$。上述分解意味着：
$$
T(2n) = 2T(n) + O(n)
$$
或者写成：
$$
T(n) = 2T(n/2) + O(n)
$$

根据主定理（Master Theorem）或直接展开：
$$
T(n) = O(n \log_2 n)
$$

**直观理解**：
如果 $n=1024 (2^{10})$：
* **直接算**：$n^2 \approx 1,000,000$ 次运算。
* **FFT**：$n \log_2 n \approx 1024 \times 10 \approx 10,000$ 次运算。
* 这是百倍的效率提升，也是数字信号处理（DSP）可行的基石。

---

## 8. 一句话复盘

* **复数线性代数**：把 $T$ 全部升级为 $H$（共轭转置），确保长度非负、自洽。
* **Fourier 矩阵**：$F_n$ 是满矩阵但拥有“正交列”，逆矩阵极易求。
* **FFT**：通过 $F_{2n} = \dots F_n \dots$ 的递归分解，把计算复杂度从 $n^2$ 降维打击到 $n\log n$。