---
title: 第24讲：马尔可夫矩阵与傅里叶级数
date: 2025-12-20
---
# MIT 18.06 线性代数 第24讲：Markov 矩阵与 Fourier 级数（重点梳理）

> 讲次主题：Markov matrices; Fourier series  
> 主线：用**特征值/特征向量**解释离散迭代的长期行为；用**正交投影/正交基**解释 Fourier 展开系数的来源。

---

## 0. 本讲解决了哪些问题（结论先行）

1) **离散时间迭代系统的长期行为（Markov 链）**  
给定迭代 $u_{k+1}=Au_k$，当 $A$ 是 Markov 矩阵时：  
- 为什么会出现“稳态”（steady state）？  
- 为什么稳态与特征值 $\lambda=1$ 直接对应？  
- 为什么（在常见情形下）其它特征值满足 $|\lambda|<1$，从而迭代会收敛到稳态？  
- 如何用特征分解快速写出 $u_k$（例如“第 100 步”的状态）？

2) **函数的正交展开（Fourier 级数）**  
- 如何把“向量在正交基上的展开”迁移到“函数在正交函数基上的展开”？  
- 为什么 Fourier 系数可以用“乘以基函数再积分”的方式直接得到？  
- 在函数空间里，正交性如何通过“内积（积分）”来表达？

---

## 1. 老师如何引入（Lecture 的结构与动机）

### 1.1 从“特征值解释长期行为”切入：连续 vs 离散
老师把前面讲过的连续系统（微分方程）和本讲的离散系统（矩阵幂）对照起来：

- 连续时间：$u'(t)=Au(t)$，解涉及 $e^{\lambda t}$。稳态对应 $\lambda=0$（因为 $e^{0t}=1$）。
- 离散时间：$u_{k+1}=Au_k$，解涉及 $\lambda^k$。稳态对应 $\lambda=1$（因为 $1^k=1$）。

因此自然引出第一部分：**Markov 矩阵下的迭代系统与稳态**。

---

## 2. Part A：Markov 矩阵（定义、性质、例子、解决的问题）

### 2.1 Markov 矩阵的定义（课堂口径：列随机）
老师采用“列和为 1”的版本（column-stochastic），并强调：

- 非负性：  
$$
a_{ij}\ge 0
$$

- 每一列之和为 1：  
$$
\sum_i a_{ij}=1\quad(\text{对每一列 }j)
$$

直观解释：列表示“从某个状态出发”分配到各状态的概率；概率非负且总和为 1。

---

### 2.2 关键结论（本讲用来解释长期行为的核心）
老师把线性代数的结论落到 Markov 上，强调两点：

1) $A$ 一定有特征值 $\lambda=1$。  
2) 其它特征值在常见情形下满足 $|\lambda|<1$（从而对应分量会衰减）。

这两点直接回答“为什么会收敛到稳态”。

---

### 2.3 例子 1：随手写的 3×3 Markov 矩阵（用于性质讲解）
老师用一个“典型 Markov 矩阵”来说明：

- 列和为 1 等价于  
  $$
  \mathbf{1}^T A=\mathbf{1}^T
  $$
  即 $\mathbf{1}^T$ 是左特征向量（对应特征值 1）。  
- 又因为 $A$ 与 $A^T$ 有相同的特征值，所以 $A$ 本身也有特征值 1。  

并由此引出“稳态向量”的定义：

稳态 $x^*$ 满足
$$
A x^* = x^*
\quad\Longleftrightarrow\quad
(A - I)\,x^* = 0,
$$
也就是说，$x^*$ 属于矩阵 $(A - I)$ 的零空间（nullspace）。等价地，$x^*$ 是 $A$ 对应特征值 $\lambda=1$ 的特征向量。


---

### 2.4 例子 2（核心计算例子）：2×2 人口迁移模型（California / Massachusetts）
老师用两状态 Markov 链演示如何用特征分解解决“长期/第 $k$ 步”的具体计算问题。

#### (1) 状态与迭代
设
$$
u_k=\begin{bmatrix}u_{\text{Cal}}(k)\\ u_{\text{Mass}}(k)\end{bmatrix},
\qquad
u_{k+1}=Au_k.
$$

#### (2) 构造转移矩阵（列表示“从哪里来”）
- 从 California 出发：90% 留在 California，10% 去 Massachusetts  
- 从 Massachusetts 出发：20% 去 California，80% 留在 Massachusetts

于是
$$
A=
\begin{bmatrix}
0.9 & 0.2\\
0.1 & 0.8
\end{bmatrix}.
$$

#### (3) 初始条件与守恒
例如取
$$
u_0=\begin{bmatrix}0\\1000\end{bmatrix},
$$
表示开始时 1000 人都在 Massachusetts。

由于列和为 1，总量守恒：
$$
u_{\text{Cal}}(k)+u_{\text{Mass}}(k)=1000,\quad \forall k.
$$

#### (4) 特征值如何快速得到
已知一个特征值必为 $\lambda_1=1$。另一个常用迹来算：
$$
\text{trace}(A)=0.9+0.8=1.7=\lambda_1+\lambda_2
\quad\Rightarrow\quad
\lambda_2=0.7.
$$

#### (5) 特征向量与通解形式
- 对 $\lambda_1=1$：解 $(A-I)x=0$ 得到稳态方向，可取
$$
x_1=\begin{bmatrix}2\\1\end{bmatrix}.
$$
- 对 $\lambda_2=0.7$：解 $(A-0.7I)x=0$，可取
$$
x_2=\begin{bmatrix}-1\\1\end{bmatrix}.
$$

将初值展开在特征向量上（这是“怎么得出来”的核心步骤）：
$$
u_0=c_1x_1+c_2x_2,
$$
则
$$
u_k=c_1\cdot 1^k x_1+c_2\cdot 0.7^k x_2.
$$

#### (6) 解决了什么问题：稳态与“第 100 步”
- **长期稳态**：当 $k\to\infty$，$0.7^k\to 0$，所以
$$
u_\infty=c_1x_1,
$$
稳态比例由 $x_1$ 给出（这里是 California:Massachusetts = 2:1）。

- **第 100 步**：直接代入 $k=100$，
$$
u_{100}=c_1x_1+c_2\cdot 0.7^{100}x_2,
$$
由于 $0.7^{100}$ 极小，数值上几乎等于稳态。

---

## 3. Part B：从正交投影到 Fourier 级数（第二条主线）

### 3.1 过渡：为什么正交基的展开系数“直接就是内积”
若 $\{q_1,\dots,q_n\}$ 是正交归一基，任意向量 $v$ 可写作
$$
v=x_1q_1+x_2q_2+\cdots+x_nq_n.
$$

因为
$$
q_i^Tq_j=
\begin{cases}
1,& i=j,\\
0,& i\ne j,
\end{cases}
$$
两边同乘 $q_i^T$ 可得
$$
x_i=q_i^Tv.
$$

矩阵写法：令 $Q=[q_1\ \cdots\ q_n]$，则 $v=Qx$，而正交矩阵满足 $Q^{-1}=Q^T$，所以
$$
x=Q^Tv.
$$

**目的**：把“系数 = 内积（投影）”这个机制准备好，马上搬到函数空间。

---

### 3.2 函数空间的内积：用积分替代求和
向量内积是 $v^Tw=\sum v_iw_i$；函数的类比是把“求和”换成“积分”。

在 $2\pi$ 周期的 Fourier 语境中，常取
$$
\langle f,g\rangle=\int_0^{2\pi} f(x)g(x)\,dx.
$$

于是“正交”就是
$$
\langle f,g\rangle=0.
$$

例如（用于说明正交性）：
$$
\int_0^{2\pi}\sin x\cos x\,dx=0.
$$

---

### 3.3 Fourier 级数如何引入：把函数写成“正交基的线性组合”
希望表示
$$
f(x)=a_0+\sum_{n=1}^{\infty}\bigl(a_n\cos(nx)+b_n\sin(nx)\bigr).
$$

这就是“函数在一组正交函数基上的展开”，是“向量在正交基上的展开”的无限维版本。

---

### 3.4 Fourier 系数怎么求：完全复用“正交投影”的套路
以 $a_1$ 为例：对等式两边同乘 $\cos x$ 并在 $[0,2\pi]$ 上积分：
$$
\int_0^{2\pi} f(x)\cos x\,dx
=
a_1\int_0^{2\pi}\cos^2 x\,dx,
$$
因为其它项与 $\cos x$ 正交，积分为 0。

并且
$$
\int_0^{2\pi}\cos^2 x\,dx=\pi,
$$
所以
$$
a_1=\frac{1}{\pi}\int_0^{2\pi} f(x)\cos x\,dx.
$$

同理可得一般公式：
$$
a_n=\frac{1}{\pi}\int_0^{2\pi} f(x)\cos(nx)\,dx,\qquad
b_n=\frac{1}{\pi}\int_0^{2\pi} f(x)\sin(nx)\,dx.
$$

常数项 $a_0$ 本质上是 $f$ 在常数函数方向上的投影（等价于平均值）。

---

## 4. 一句话复盘（把两部分串起来）

- Markov 部分：用特征分解把 $A^k$ 拆成“稳态项（$\lambda=1$）+ 衰减项（$|\lambda|<1$）”，解释长期收敛，并可直接算第 $k$ 步。  
- Fourier 部分：用正交投影把“展开系数”变成“内积”，并把内积从有限维求和自然推广为积分，从而进入函数的正交展开。
