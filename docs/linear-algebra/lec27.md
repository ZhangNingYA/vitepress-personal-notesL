---
title: 第27讲：正定矩阵与极小值
date: 2025-12-21
---
# MIT 18.06 线性代数 第27讲：正定矩阵与极小值

> **Lecture 27: Positive definite matrices and minima**
>
> **主线逻辑**：
> 1.  **从微积分到线代**：一元函数极小值看二阶导 $f''(x)>0$；多元函数极小值看 Hessian 矩阵是否**正定**。
> 2.  **对象限定**：重点讨论 **实对称矩阵** $A=A^T$（因为它有实特征值、正交特征向量，二次型几何最清晰）。
> 3.  **核心任务**：如何“快速且可靠”判断 $A$ 是否正定？——四种等价判据（特征值 / 二次型 / 主元 / 子行列式）。
> 4.  **落地应用**：优化（极小值判定）、几何（二次曲线/曲面）、数值计算（Cholesky、稳定性）。

---

## 0. 本讲解决了哪些问题（结论先行）

### 0.1 什么是正定矩阵（Positive Definite, PD）？
对称矩阵 $A$ **正定**的本质是：它定义的二次型在除零向量外的所有方向都“严格为正”：
$$
x \neq 0 \quad \Rightarrow \quad x^T A x > 0
$$
你可以把它理解成“矩阵世界里的正数”。

### 0.2 为什么正定与极小值绑定？
在临界点处（梯度为 0），多元函数的二阶近似是一个二次型：
$$
f(x_0+h) \approx f(x_0) + \frac{1}{2} h^T H(x_0) h
$$
如果 Hessian $H(x_0)$ 正定，则二次项在任何方向都向上“抬升”，因此 $x_0$ 是**严格局部极小值**。

### 0.3 判定正定性有哪 4 种等价方法？
对称矩阵 $A \in \mathbb{R}^{n \times n}$，以下四条等价：

1.  **特征值法**：所有特征值 $\lambda_i > 0$。
2.  **定义/能量法**：对任意 $x \neq 0$， $x^T A x > 0$。
3.  **主元法（消元/LDL^T）**：不换行消元得到 $A=LDL^T$，所有主元（对角元）$d_i > 0$。
4.  **子行列式法（Sylvester 判据）**：所有左上角主子式 $D_k = \det(A_{1:k,1:k}) > 0$。

### 0.4 正定矩阵能带来哪些“工程级收益”？
* **优化**：判断极小值、证明凸性、二次规划可解性。
* **几何**：$x^TAx=1$ 是椭圆/椭球（封闭、有界）。
* **数值**：正定 $\Rightarrow$ 可做 **Cholesky 分解**，解线性系统更快更稳。

---

## 1. 从微积分引入：极小值的二阶条件

### 1.1 一元回顾：为什么看二阶导？
在 $x_0$ 处若 $f'(x_0)=0$，泰勒展开：
$$
f(x_0+h) = f(x_0) + \frac{1}{2} f''(x_0)h^2 + o(h^2)
$$
* 若 $f''(x_0) > 0$，则小 $h$ 下 $f(x_0+h) - f(x_0) \approx \frac{1}{2} f''(x_0)h^2 > 0$，所以是极小值。

### 1.2 多元推广：Hessian 出现的必然性
对 $f: \mathbb{R}^n \to \mathbb{R}$，在点 $x_0$：
$$
f(x_0+h) = f(x_0) + \nabla f(x_0)^T h + \frac{1}{2} h^T H(x_0)h + o(\|h\|^2)
$$
若 $x_0$ 为临界点（$\nabla f(x_0)=0$），则主导项变为二次型：
$$
f(x_0+h) - f(x_0) \approx \frac{1}{2} h^T H(x_0) h
$$
因此：
* $H(x_0)$ **正定** $\Rightarrow$ 严格局部极小值
* $H(x_0)$ **负定** $\Rightarrow$ 严格局部极大值
* $H(x_0)$ **不定** $\Rightarrow$ 鞍点
* $H(x_0)$ **半正定** $\Rightarrow$ 需要更高阶项判定（可能是“平底”）

> 这里 “正定/负定/半正定/不定” 完全是线性代数语言，但它精确对应了函数图形“碗/倒碗/平底/马鞍”的形状。

---

## 2. 核心定义：二次型与正定性

### 2.1 二次型（Quadratic Form）
给定对称矩阵 $A$，定义二次型：
$$
q(x) = x^T A x
$$
在 $n=2$ 时，若
$$
A = \begin{bmatrix} a & b \\ b & c \end{bmatrix}, \quad x = \begin{bmatrix} x \\ y \end{bmatrix}
$$
则
$$
q(x,y) = ax^2 + 2bxy + cy^2
$$
注意交叉项系数是 $2b$（很多人容易漏掉 2）。

### 2.2 正定/半正定/负定/不定的统一表述
对称矩阵 $A$：
* **正定 (PD)**：$\forall x \neq 0, \ x^TAx > 0$
* **半正定 (PSD)**：$\forall x, \ x^TAx \ge 0$
* **负定 (ND)**：$\forall x \neq 0, \ x^TAx < 0$
* **不定 (Indefinite)**：存在 $x,y$ 使 $x^TAx > 0$ 且 $y^TAy < 0$

---

## 3. 为什么“对称”如此关键：谱分解带来一切清晰性

### 3.1 谱分解（Spectral Theorem）
实对称矩阵必可正交对角化：
$$
A = Q \Lambda Q^T
$$
其中 $Q$ 为正交矩阵（列为单位正交特征向量），$\Lambda = \text{diag}(\lambda_1, \dots, \lambda_n)$。

### 3.2 用谱分解直接“推导”正定与特征值等价
令 $y = Q^T x$（正交变换仅改变坐标、不改变长度），则：
$$
x^T A x = x^T Q \Lambda Q^T x = y^T \Lambda y = \sum_{i=1}^n \lambda_i y_i^2
$$
于是：
* 若所有 $\lambda_i > 0$，则对任意非零 $y$，$\sum \lambda_i y_i^2 > 0$，所以 $A$ 正定。
* 反之，若存在某个 $\lambda_j \le 0$，取 $y=e_j$（第 $j$ 个标准基向量），则 $y^T\Lambda y = \lambda_j \le 0$，从而存在 $x=Qy \neq 0$ 使 $x^TAx \le 0$，不可能正定。

这就给出了 **判据 1（特征值法）** 与 **判据 4（能量法）** 的本质联系。

---

## 4. 正定性的 4 种等价判定（重点）

下面以 $2 \times 2$ 矩阵贯穿直觉，再给出 $n \times n$ 的一般形式。

---

### 判定 1：特征值测试（Eigenvalue Test）
**结论**：对称矩阵 $A$ 正定 $\Longleftrightarrow$ 所有特征值 $\lambda_i > 0$。

**直觉**：特征向量给出“主轴方向”，特征值给出沿主轴方向的“曲率/刚度”。主轴曲率全为正，整体就是碗。

---

### 判定 2：能量/定义测试（Energy / Definition）
**结论**：$A$ 正定 $\Longleftrightarrow$ $\forall x \neq 0, \ x^TAx > 0$。

**为什么叫能量？**
在物理/工程中，很多系统能量写成 $x^TAx$（弹簧势能、离散化后的能量泛函等）。能量“严格为正”意味着系统稳定、不存在“零刚度”的非平凡形变方向。

---

### 判定 3：主元测试（Pivot Test via $LDL^T$）
对称矩阵做消元（不换行）可写为：
$$
A = L D L^T
$$
其中 $L$ 是单位下三角矩阵，$D$ 是对角矩阵（其对角元就是“主元” $d_1, \dots, d_n$）。

**结论**：对称矩阵 $A$ 正定 $\Longleftrightarrow$ 所有主元 $d_i > 0$。

**推导关键点（把“主元为何能判定正定”说清楚）**
利用分解：
$$
x^TAx = x^T L D L^T x = (L^T x)^T D (L^T x)
$$
令 $z = L^Tx$（$L$ 可逆，$x \neq 0 \Rightarrow z \neq 0$），则
$$
x^TAx = z^T D z = \sum_{i=1}^n d_i z_i^2
$$
因此只要 $d_i > 0$，右侧严格为正；反过来若某个 $d_i \le 0$，取 $z=e_i$ 就能构造出 $x \neq 0$ 使 $x^TAx \le 0$。

**工程意义**：主元法不需要算特征值，通常比特征值法更快、更适合大规模稀疏矩阵。

---

### 判定 4：子行列式测试（Leading Principal Minors / Sylvester Criterion）
定义左上角主子式：
$$
D_k = \det(A_{1:k, 1:k}), \quad k=1, \dots, n
$$
**结论**：对称矩阵 $A$ 正定 $\Longleftrightarrow$ 所有 $D_k > 0$。

#### 4.1 为什么“只看左上角”就够？
这不是随意的，而是与消元过程严格绑定：做 $LDL^T$ 分解时，第 $k$ 步只涉及左上角的 $k \times k$ 块，因而 $D_k$ 恰好捕捉到“前 $k$ 步的稳定性”。

#### 4.2 子行列式与主元的精确关系（重要推导）
由 $A=LDL^T$：
$$
\det(A_{1:k, 1:k}) = \det(L_{1:k, 1:k}) \det(D_{1:k, 1:k}) \det(L_{1:k, 1:k}^T)
$$
而单位下三角矩阵的行列式为 1，所以：
$$
D_k = \prod_{i=1}^k d_i
$$
于是得到：
$$
d_k = \frac{D_k}{D_{k-1}}, \quad (D_0 := 1)
$$
因此：
* 若所有 $D_k > 0$，则所有 $d_k > 0$；
* 若所有 $d_k > 0$，则所有 $D_k > 0$。

这就把 **判据 3** 与 **判据 4** 完整打通。

---

## 5. 2×2 例子：固定 $a,b$，调 $c$ 看相变（半正定/不定/正定）

考虑：
$$
A = \begin{bmatrix} 2 & 6 \\ 6 & c \end{bmatrix}, \qquad q(x,y) = 2x^2 + 12xy + cy^2
$$

### 5.1 情况 A：$c=18$ —— 半正定（PSD）
* 子行列式：
    $$
    D_1 = 2 > 0, \quad D_2 = \det(A) = 2 \cdot 18 - 36 = 0
    $$
* 完全平方（配方法）：
    $$
    q(x,y) = 2(x+3y)^2 \ge 0
    $$
* 解释：在方向 $x=-3y$ 上，$q=0$，出现“平坦谷槽”。

结论：**半正定**（非严格“碗”，是“有一条平底”）。

---

### 5.2 情况 B：$c=7$ —— 不定（Indefinite）
* 行列式：
    $$
    D_2 = 2 \cdot 7 - 36 = -22 < 0
    $$
* 主元：
    $$
    d_1 = 2, \quad d_2 = \frac{D_2}{D_1} = \frac{-22}{2} = -11
    $$
    一正一负 $\Rightarrow$ 必不定。

结论：**鞍点结构**（一个方向上升、另一个方向下降）。

---

### 5.3 情况 C：$c=20$ —— 正定（PD）
* 子行列式：
    $$
    D_1 = 2 > 0, \quad D_2 = 2 \cdot 20 - 36 = 4 > 0
    $$
* 主元：
    $$
    d_1 = 2 > 0, \quad d_2 = \frac{D_2}{D_1} = \frac{4}{2} = 2 > 0
    $$
* 配方法：
    $$
    q(x,y) = 2x^2 + 12xy + 20y^2 = 2(x+3y)^2 + 2y^2 > 0 \quad ((x,y) \neq (0,0))
    $$

结论：**正定**（严格“碗形”）。

---

## 6. 几何解释：椭圆 vs 双曲线（用 $x^TAx=1$ 统一看）

考虑二维曲线：
$$
x^T A x = 1
$$

### 6.1 $A$ 正定 ⇒ 椭圆（封闭、有界）
若 $A$ 正定，则 $x^TAx$ 在任意方向都增长，$x^TAx=1$ 的解集必然被“束缚”在某个有限范围内，因此是椭圆。

更进一步，用谱分解 $A=Q\Lambda Q^T$：
$$
x^TAx=1 \iff y^T\Lambda y=1 \iff \sum_{i=1}^2 \lambda_i y_i^2 = 1
$$
这是标准椭圆方程。主轴方向由 $Q$ 给出，轴长与 $1/\sqrt{\lambda_i}$ 成正比。

### 6.2 $A$ 不定 ⇒ 双曲线（开口、发散）
若 $A$ 有一正一负特征值，则在某些方向 $x^TAx$ 变负，等值线 $x^TAx=1$ 会“向无穷延伸”，典型就是双曲线。

---

## 7. 关键推论与扩展（把“可用性”再往前推一步）

### 7.1 为什么 $A^TA$ 至少半正定？什么时候正定？
对任意矩阵 $A \in \mathbb{R}^{m \times n}$：
$$
x^T(A^TA)x = (Ax)^T(Ax) = \|Ax\|^2 \ge 0
$$
所以 $A^TA$ 总是 **半正定**。

什么时候是正定？
当且仅当 $Ax=0 \Rightarrow x=0$，也就是 $A$ 的列向量线性无关（满列秩）。此时 $\|Ax\|^2=0$ 只能由 $x=0$ 导致。

---

### 7.2 正定 ⇔ Cholesky 分解存在（数值计算非常重要）
对称正定矩阵不仅能 $LDL^T$，还能分解为：
$$
A = R^T R \quad (\text{或 } A = LL^T)
$$
这就是 Cholesky 分解（$R$ 上三角 / $L$ 下三角）。它的意义：
* 解 $Ax=b$ 更快（两次三角求解）
* 数值更稳定（不需要换行，且不会出现“负的主元”导致崩溃）

> 在实际算法里，“矩阵是否正定”往往通过能否成功做 Cholesky 来检测。

---

### 7.3 与凸性（Convexity）的直接联系
若函数 $f$ 二阶可导，且对任意 $x$，Hessian 满足：
* $H(x) \succeq 0$（半正定）$\Rightarrow f$ 是凸函数
* $H(x) \succ 0$（正定）$\Rightarrow f$ 是严格凸函数（极小值唯一）

这也是为什么优化里正定性非常核心：它决定了“最小值是否稳定且唯一”。

---

## 8. Hessian 在二维的“手算判据”如何对应 Sylvester？

二维 Hessian：
$$
H = \begin{bmatrix} f_{xx} & f_{xy} \\ f_{yx} & f_{yy} \end{bmatrix} \quad (\text{通常 } f_{xy}=f_{yx})
$$
Sylvester 判据在 $2 \times 2$ 上就是：
$$
D_1 = f_{xx} > 0, \qquad D_2 = \det(H) = f_{xx}f_{yy} - f_{xy}^2 > 0
$$
于是得到常见微积分二元二阶判别法：
* $f_{xx} > 0$ 且 $\det(H) > 0 \Rightarrow$ 极小值
* $f_{xx} < 0$ 且 $\det(H) > 0 \Rightarrow$ 极大值
* $\det(H) < 0 \Rightarrow$ 鞍点

---

## 9. 一句话复盘（可当背诵版）

对称矩阵“正定”意味着二次型 $x^TAx$ 在所有非零方向都为正；这等价于 **特征值全正**、**主元全正**、**左上角主子式全正**。在优化里，Hessian 正定就是“严格极小值”的数学版本；在几何里，$x^TAx=1$ 就是椭圆/椭球；在数值计算里，正定让 Cholesky 成为最快最稳的解法之一。

---

## 10. 自检题（建议做完再看答案）

1.  对称矩阵 $A$ 的行列式 $\det(A) > 0$ 是否足以推出 $A$ 正定？请举反例并说明原因。
2.  证明：若 $A$ 正定，则 $A$ 可逆，并且 $A^{-1}$ 也是正定。
3.  若 $A$ 正定，证明 $x^TAx \ge \lambda_{\min}\|x\|^2$，其中 $\lambda_{\min}$ 为最小特征值。
4.  设 $A$ 对称，$A=LDL^T$，解释为什么“出现非正主元”意味着 $A$ 不是正定。
5.  给定 $A=\begin{bmatrix}a&b\\b&c\end{bmatrix}$，推导正定条件为 $a>0$ 且 $ac-b^2>0$。